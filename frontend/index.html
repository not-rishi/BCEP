<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BMSCE Club Events Portal</title>
    <link rel="icon" type="image/png" href="Data/Images/logo.png" />
    <link rel="stylesheet" href="Loader/loader.css" />
    <link rel="stylesheet" href="landing.css" />
  </head>
  <body>
    <div id="loader-wrapper">
      <img id="loader-logo" src="Data/Images/logo.png" alt="Logo" />
      <div class="progress-container"><div class="progress-bar"></div></div>
    </div>
    <script src="Loader/loader.js"></script>
    <script src="config.js"></script>
    <div id="vanta-bg">
      <nav>
        <div class="nav-left">
          <a href="index.html">
            <img src="Data/Images/logo.png" alt="Logo" class="logo" />
          </a>
        </div>
        <div class="nav-right">
          <a href="Pages/landing/login.html">Sign in</a>
          <a href="Pages/landing/about.html">About</a>
        </div>
      </nav>
      <section class="landing">
        <div class="branding">
          <img src="Data/Images/logo.png" alt="Logo" />
          <h1>BMSCE Club Events</h1>
        </div>
      </section>
      <section class="content">
        <section class="events-section">
          <h2>Events Happening Now</h2>
          <div class="events-scroll" id="events-container"></div>
        </section>
      </section>

      <div class="club-scrolls">
        <h3>Our Clubs</h3>
        <a href="https://bmsce.ac.in/home/Extra-Curricular-Activities">
          <div class="club-marquee">
            <div class="club-track reverse">
              <div class="club-card-container">
                <div class="club-card">Electronics Society</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">IIC BMSCE</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">International Society of Automation</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">ISCB Student Chapter</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">ISE Student Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Pentagram</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Protocol</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Robotics Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Tedx BMSCE</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Google Developer Student Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Code1O</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE SSIT Chapter</div>
              </div>
            </div>
          </div>
          <div class="club-marquee">
            <div class="club-track">
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE PELS & IES Joint Chapter</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Respawn Gaming Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Business Insights</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE ACM Student Chapter</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Inksanity</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Mountaineering Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">National Service Scheme</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Rotaract Club of BMSCE</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Samskruthi Sambhrama</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Singularity</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMS MUNSOC</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMS Photography Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Codelocked</div>
              </div>
            </div>
          </div>
          <div class="club-marquee">
            <div class="club-track reverse">
              <div class="club-card-container">
                <div class="club-card">Danz Addix</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Fine Arts Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Ninaad</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Panache</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Paramvah Dance</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Prakruthi</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Pravrutthi</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">The Groovehouse</div>
              </div>
              <div class="club-card-container">
                 <div class="club-card">Vak</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Chiranthana</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Manusmaran</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Gradient Student Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Leo Satva</div>
              </div>
            </div>
          </div>
          <div class="club-marquee">
            <div class="club-track">
              <div class="club-card-container">
                <div class="club-card">Aquila BMSCE</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">Augment Ai</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE Computer Society</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE PES & Sensors Council</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE SB Student Branch</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE IEEE WIE</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE Quiz Club</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">BMSCE Upagraha</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">SAE Bullz Racing</div>
              </div>
              <div class="club-card-container">
                <div class="club-card">CIIE</div>
              </div>
            </div>
          </div>
        </a>
      </div>

      <footer class="footer">
        <div class="footer-header">
          <img src= 'Data/Images/logo.png'" alt="Logo"/>
          <p>BMSCE Club Events</p>
        </div>
        <p>
          Empowering student communities through collaboration, innovation, and
          creativity.
        </p>
        <p class="copyright">© 2025 BMSCE Club Events. All rights reserved.</p>
      </footer>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tracks = document.querySelectorAll(".club-track");
        tracks.forEach((track) => {
          const cards = Array.from(track.children);
          cards.forEach((card) => {
            track.appendChild(card.cloneNode(true));
          });
        });
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.fog.min.js"></script>
    <script>
      let vanta;
      document.addEventListener("DOMContentLoaded", () => {
        vanta = VANTA.FOG({
          el: "#vanta-bg",
          mouseControls: true,
          touchControls: true,
          gyroControls: false,
          minHeight: 200.0,
          minWidth: 200.0,
          highlightColor: 0x954900,
          midtoneColor: 0x98ff,
          lowlightColor: 0x0,
          baseColor: 0x0,
          speed: 1,
          zoom: 2.1,
        });
        window.addEventListener("load", () => {
          if (vanta && vanta.resize) vanta.resize();
        });
        setTimeout(() => {
          if (vanta && vanta.resize) vanta.resize();
        }, 1000);
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const marquees = document.querySelectorAll(".club-marquee");

        marquees.forEach((marquee) => {
          marquee.addEventListener("mouseenter", () => {
            const track = marquee.querySelector(".club-track");
            if (track) {
              track
                .getAnimations()
                .forEach((anim) => anim.updatePlaybackRate(0.3));
            }
          });

          marquee.addEventListener("mouseleave", () => {
            const track = marquee.querySelector(".club-track");
            if (track) {
              track
                .getAnimations()
                .forEach((anim) => anim.updatePlaybackRate(1.0));
            }
          });
        });
      });
    </script>
    <script>
      async function loadEvents() {
        try {
          const response = await apiFetch("/events/all");
          const events = await response.json();
          const container = document.getElementById("events-container");
          container.innerHTML = "";
          events.forEach((ev) => {
            let dateDisplay = "Date TBA";
            if (ev.eventDateTime) {
              const dt = new Date(ev.eventDateTime);
              const d = dt.toLocaleDateString("en-US", {
                month: "short",
                day: "numeric",
              });
              const t = dt.toLocaleTimeString("en-US", {
                hour: "2-digit",
                minute: "2-digit",
              });
              dateDisplay = `${d} • ${t}`;
            } else if (ev.deadline) {
              dateDisplay = new Date(ev.deadline)
                .toDateString()
                .split(" ")
                .slice(1, 3)
                .join(" ");
            }
            const wrapper = document.createElement("div");
            wrapper.className = "event-card-wrapper";
            const card = document.createElement("a");
            card.href = "Pages/landing/login.html";
            card.innerHTML = `
                <div class="event-card">
                  <h3 class="event-title">${ev.title}</h3>
                  <p class="club-name">${ev.club}</p>
                  <p class="event-info">${ev.description}</p>
                  <p class="last-date">${dateDisplay}</p> 
                </div>
            `;
            if (ev.posterUrl) {
              const poster = document.createElement("div");
              poster.className = "poster-float";
              poster.style.setProperty("--poster-bg", `url('${ev.posterUrl}')`);
              poster.innerHTML = `<img src="${ev.posterUrl}" alt="Poster">`;
              wrapper.appendChild(poster);
            }
            wrapper.appendChild(card);
            container.appendChild(wrapper);
          });
          if (vanta && vanta.resize) {
            console.log("Resizing Vanta after events loaded.");
            vanta.resize();
          }
        } catch (err) {
          console.error("Error loading events:", err);
        } finally {
          if (window.hideCustomLoader) {
            window.hideCustomLoader();
          }
        }
      }

      loadEvents();
      // async function wakeBackend() {
      //   try {
      //     await fetch("https://bcep-server.onrender.com/");
      //   } catch (e) {
      //     console.log("Backend waking up…");
      //   }
      // }

      // (async () => {
      //   await wakeBackend();
      //   setTimeout(loadEvents, 1500);
      // })();
    </script>
  </body>
</html>
